#1. Install and Load Libraries 
install.packages("car")
install.packages("sm")
install.packages("ggplot2") # for general plots
install.packages("MASS") # for polr package
install.packages("generalhoslem") # for testing model fit (lipsitz test and two others)
install.packages("qwraps2") # for summary_table use
install.packages("quantreg") # testing quantile plots (geom_quantile) and quantile regressions
install.packages ("olsrr") #for testing normality
install.packages("plyr") #for count and other cool things


library(car)
library(sm)
library(ggplot2) 
library(MASS) 
library(generalhoslem) 
library(qwraps2) 
library(quantreg) 
library(olsrr)
library(plyr)

#2. Check and Set Working Directory
      #LAB
      setwd("/Users/labuser/Documents/R")
      getwd() #to see where is set to
      #LAPTOP
      setwd("~/Desktop")
      getwd()
      
      
#3. Import Data [[make sure is most recent version and saved as csv]]
      Map <- read.csv("Mapping_Coding_CH_191119.csv", na.strings = "N/A")
      View(Map)
      # <- saves MC as an object, read.csv() imports it    
  
  
 ## BASIC DEMOGRAPHICS ## 

      Map_EE_Demo <- subset(Map, Map$Group_4cat == "English Early", Map$Age_Rounded<10 | is.na(Map$Age_Rounded))
      View(Map_EE_Demo) #44 total English Early kids (no kids > 10)

      Total_Inc_Study <- subset(Map_EE_Demo, Map_EE_Demo$Including.in.Study == "Yes")
      View(Total_Inc_Study)
      # 42 total kids included in study

      Total_Not_Inc_Study <- subset(Map_EE_Demo, Map_EE_Demo$Including.in.Study == "No" | Map_EE_Demo$Including.in.Study== "")
      nrow(Total_Not_Inc_Study)
      View(Total_Not_Inc_Study)
      # 2 total kids not included in study
      
      Total_Blank_NA <- subset(Map_EE_Demo, Map_EE_Demo$Including.in.Study == "" | is.na(Map_EE_Demo$Including.in.Study))
      # 0 blanks or N/As

      Tested_Not_Inc <- subset(Map_EE_Demo, Map_EE_Demo$Including.in.Study != "Yes" & Map_EE_Demo$Date.Tested != "")
      View(Tested_Not_Inc)
      # 0 kids not included in study that were tested. If do have any, need to explain why they were not included!
          
                   
  # SEX 
  sum(Total_Inc_Study$M.F=='Female') # 20
  sum(Total_Inc_Study$M.F=='Male') # 22
  sum(Total_Inc_Study$M.F=='N/A') # 0
  
  # RACE DESCRIPTIVE STATISTICS
   #group N/A & unsure together
   count((Total_Inc_Study$Race))
  
  # ETHNICITY DESCRIPTIVE STATISTICS
  count((Total_Inc_Study$Ethnicity))
      
  # AGE DESCRIPTIVE STATISTICS    
  min(Total_Inc_Study$Age_Rounded, na.rm=TRUE) # 5.1
  max(Total_Inc_Study$Age_Rounded, na.rm=TRUE) # 9.7
  median(Total_Inc_Study$Age_Rounded, na.rm=TRUE) # 6.9
  mean(Total_Inc_Study$Age_Rounded, na.rm=TRUE) # 6.985714
  sd(Total_Inc_Study$Age_Rounded, na.rm=TRUE) # 1.319381
  range(Total_Inc_Study$Age_Rounded, na.rm=TRUE) # 5.1 - 9.7
  
      #AGE VIOLIN
      ggplot(Total_Inc_Study, aes(x=Total_Inc_Study$Group_4cat, y=Total_Inc_Study$Age_Rounded)) + geom_violin()
  
  # SES DESCRIPTIVE STATISTICS
  min(Total_Inc_Study$SES_range_8_to_66, na.rm=TRUE) # 17
  max(Total_Inc_Study$SES_range_8_to_66, na.rm=TRUE) # 66
  median(Total_Inc_Study$SES_range_8_to_66, na.rm=TRUE) # 61
  mean(Total_Inc_Study$SES_range_8_to_66, na.rm=TRUE) # 55.5
  sd(Total_Inc_Study$SES_range_8_to_66, na.rm=TRUE) # 12.9
  range(Total_Inc_Study$SES_range_8_to_66, na.rm=TRUE) # 17 - 66
            
      #SES VIOLIN
      ggplot(Total_Inc_Study, aes(x=Total_Inc_Study$Group_4cat, y=Total_Inc_Study$SES_range_8_to_66)) + geom_violin()


  # Find observations with missing Age and SES values
      which(is.na(Total_Inc_Study$Age_Rounded)) # 0 observations missing Age value
      Missing_Age <- Total_Inc_Study[which(is.na(Total_Inc_Study$Age_Rounded)),3]
      View(Missing_Age)

      which(is.na(Total_Inc_Study$SES)) # 0 observations missing SES value
      Missing_SES <- Total_Inc_Study[which(is.na(Total_Inc_Study$SES_range_8_to_66)),3]
      View(Missing_SES)
      
      Incorrect_SES <- subset(Total_Inc_Study, Total_Inc_Study$SES_range_8_to_66 < 3 | Total_Inc_Study$SES_range_8_to_66 == "")
      View(Incorrect_SES)
      #No observations of SES < 3
