## SCATTER PLOTS FOR MAPPING TYPES BY AGE GROUPS AND SET SIZES ##
#1. NUMERAL TO WORD SCATTER PLOT#
long_setsizes_NW  <- Map_HBE[,-(298)] #getting rid of sum columns to only have avg ones
long_setsizes_NW2  <- pivot_longer(data = long_setsizes_NW, cols=c(ends_with("WordNumeral")), names_to = c("SetSize"), values_to = "Performance") 
View(long_setsizes_NW2)
long_setsizes_NW2$AgeGrp <- ifelse(long_setsizes_NW2$Age_Rounded < 7, "5", "7") #adding age grp column to only have the numbers
View(long_setsizes_NW2) 
AgeGrps <- long_setsizes_NW2$AgeGrp #creating short variable
long_setsizes_NW2$SetSize <- factor(long_setsizes_NW2$SetSize, levels=c("AvgCorrect_Sm_WordNumeral", "AvgCorrect_Med_WordNumeral", "AvgCorrect_Lrg_WordNumeral")) #SETTING IN ORDER, from small to large
jitter <- position_jitter(width=0.4, height=0.02)
NW <- ggplot(long_setsizes_NW2, aes(x=long_setsizes_NW2$SetSize, y=long_setsizes_NW2$Performance)) + geom_point(aes(shape=AgeGrps, color=AgeGrps), show.legend = FALSE, position=jitter, size=2)+ stat_smooth(aes(group = AgeGrps, color=AgeGrps), method = "loess", se=FALSE) + labs(x="Set Sizes", y="Numeral-Word") + theme(text = element_text(size=20, family="Times New Roman"), legend.position = "none") + coord_cartesian(ylim= c(0.4,1)) + scale_y_continuous(breaks=c(0.5, 0.6, 0.7, 0.8, 0.9, 1))  + scale_color_manual(values=c("black","blue1")) + scale_x_discrete(labels=c("AvgCorrect_Sm_WordNumeral" = "Small", "AvgCorrect_Med_WordNumeral" = "Medium", "AvgCorrect_Lrg_WordNumeral" = "Large"))
NW

#2. WORD TO NUMERAL SCATTER PLOT#
long_setsizes_WN  <- Map_HBE[,-(270)] #getting rid of sum columns to only have avg ones
long_setsizes_WN2  <- pivot_longer(data = long_setsizes_WN, cols=c(ends_with("NumeralWord")), names_to = c("SetSize"), values_to = "Performance") 
View(long_setsizes_WN2)
long_setsizes_WN2$AgeGrp <- ifelse(long_setsizes_WN2$Age_Rounded < 7, "5", "7") #adding age grp column to only have the numbers
View(long_setsizes_WN2) 
AgeGrps <- long_setsizes_WN2$AgeGrp #creating short variable
long_setsizes_WN2$SetSize <- factor(long_setsizes_WN2$SetSize, levels=c("AvgCorrect_Sm_NumeralWord", "AvgCorrect_Med_NumeralWord", "AvgCorrect_Lrg_NumeralWord")) #SETTING IN ORDER, from small to large
jitter <- position_jitter(width=0.4, height=0.02)
WN <- ggplot(long_setsizes_WN2, aes(x=long_setsizes_WN2$SetSize, y=long_setsizes_WN2$Performance)) + geom_point(aes(shape=AgeGrps, color=AgeGrps), show.legend = FALSE, position=jitter, size=2)+ stat_smooth(aes(group = AgeGrps, color=AgeGrps), method = "loess", se=FALSE) + labs(x="Set Sizes", y="Word-Numeral") + theme(text = element_text(size=20, family="Times New Roman"), legend.position = "none") + coord_cartesian(ylim= c(0.4,1)) + scale_y_continuous(breaks=c(0.5, 0.6, 0.7, 0.8, 0.9, 1))  + scale_color_manual(values=c("black","blue1")) + scale_x_discrete(labels=c("AvgCorrect_Sm_NumeralWord" = "Small", "AvgCorrect_Med_NumeralWord" = "Medium", "AvgCorrect_Lrg_NumeralWord" = "Large"))
WN

#3. WORD TO QUANTITY SCATTER PLOT#
#which(colnames(Map_HBE)=="SumTotal_QuantityWord") #find number of column
long_setsizes_WQ  <- Map_HBE[,-(187)] #getting rid of sum columns to only have avg ones
long_setsizes_WQ2  <- pivot_longer(data = long_setsizes_WQ, cols=c(ends_with("QuantityWord")), names_to = c("SetSize"), values_to = "Performance") 
View(long_setsizes_WQ2)
long_setsizes_WQ2$AgeGrp <- ifelse(long_setsizes_WQ2$Age_Rounded < 7, "5", "7") #adding age grp column to only have the numbers
View(long_setsizes_WQ2) 
AgeGrps <- long_setsizes_WQ2$AgeGrp #creating short variable
long_setsizes_WQ2$SetSize <- factor(long_setsizes_WQ2$SetSize, levels=c("AvgCorrect_Sm_QuantityWord", "AvgCorrect_Med_QuantityWord", "AvgCorrect_Lrg_QuantityWord")) #SETTING IN ORDER, from small to large
jitter <- position_jitter(width=0.4, height=0.02)
WQ <- ggplot(long_setsizes_WQ2, aes(x=long_setsizes_WQ2$SetSize, y=long_setsizes_WQ2$Performance)) + geom_point(aes(shape=AgeGrps, color=AgeGrps), show.legend = FALSE, position=jitter, size=2)+ stat_smooth(aes(group = AgeGrps, color=AgeGrps), method = "loess", se=FALSE) + labs(x="Set Sizes", y="Word-Quantity") + theme(text = element_text(size=20, family="Times New Roman"), legend.position = "none") + coord_cartesian(ylim= c(0.4,1)) + scale_y_continuous(breaks=c(0.5, 0.6, 0.7, 0.8, 0.9, 1))  + scale_color_manual(values=c("black","blue1")) + scale_x_discrete(labels=c("AvgCorrect_Sm_QuantityWord" = "Small", "AvgCorrect_Med_QuantityWord" = "Medium", "AvgCorrect_Lrg_QuantityWord" = "Large"))
WQ

#4. QUANTITY TO WORD SCATTER PLOT#
which(colnames(Map_HBE)=="SumTotal_WordQuantity")
long_setsizes_QW  <- Map_HBE[,-(239)] #getting rid of sum columns to only have avg ones
long_setsizes_QW2  <- pivot_longer(data = long_setsizes_QW, cols=c(ends_with("WordQuantity")), names_to = c("SetSize"), values_to = "Performance") 
View(long_setsizes_QW2)
long_setsizes_QW2$AgeGrp <- ifelse(long_setsizes_QW2$Age_Rounded < 7, "5", "7") #adding age grp column to only have the numbers
View(long_setsizes_QW2) 
AgeGrps <- long_setsizes_QW2$AgeGrp #creating short variable
long_setsizes_QW2$SetSize <- factor(long_setsizes_QW2$SetSize, levels=c("AvgCorrect_Sm_WordQuantity", "AvgCorrect_Med_WordQuantity", "AvgCorrect_Lrg_WordQuantity")) #SETTING IN ORDER, from small to large
jitter <- position_jitter(width=0.4, height=0.02)
QW <- ggplot(long_setsizes_QW2, aes(x=long_setsizes_QW2$SetSize, y=long_setsizes_QW2$Performance)) + geom_point(aes(shape=AgeGrps, color=AgeGrps), show.legend = FALSE, position=jitter, size=2)+ stat_smooth(aes(group = AgeGrps, color=AgeGrps), method = "loess", se=FALSE) + labs(x="Set Sizes", y="Quantity-Word") + theme(text = element_text(size=20, family="Times New Roman"), legend.position = "none") + coord_cartesian(ylim= c(0.4,1)) + scale_y_continuous(breaks=c(0.5, 0.6, 0.7, 0.8, 0.9, 1))  + scale_color_manual(values=c("black","blue1")) + scale_x_discrete(labels=c("AvgCorrect_Sm_WordQuantity" = "Small", "AvgCorrect_Med_WordQuantity" = "Medium", "AvgCorrect_Lrg_WordQuantity" = "Large"))
QW

#5. QUANTITY TO NUMERAL SCATTER PLOT#
which(colnames(Map_HBE)=="SumTotal_NumeralQuantity")
long_setsizes_QN  <- Map_HBE[,-(129)] #getting rid of sum columns to only have avg ones
long_setsizes_QN2  <- pivot_longer(data = long_setsizes_QN, cols=c(ends_with("NumeralQuantity")), names_to = c("SetSize"), values_to = "Performance") 
View(long_setsizes_QN2)
long_setsizes_QN2$AgeGrp <- ifelse(long_setsizes_QN2$Age_Rounded < 7, "5", "7") #adding age grp column to only have the numbers
View(long_setsizes_QN2) 
AgeGrps <- long_setsizes_QN2$AgeGrp #creating short variable
long_setsizes_QN2$SetSize <- factor(long_setsizes_QN2$SetSize, levels=c("AvgCorrect_Sm_NumeralQuantity", "AvgCorrect_Med_NumeralQuantity", "AvgCorrect_Lrg_NumeralQuantity")) #SETTING IN ORDER, from small to large
jitter <- position_jitter(width=0.4, height=0.02)
QN <- ggplot(long_setsizes_QN2, aes(x=long_setsizes_QN2$SetSize, y=long_setsizes_QN2$Performance)) + geom_point(aes(shape=AgeGrps, color=AgeGrps), show.legend = FALSE, position=jitter, size=2)+ stat_smooth(aes(group = AgeGrps, color=AgeGrps), method = "loess", se=FALSE) + labs(x="Set Sizes", y="Quantity-Numeral") + theme(text = element_text(size=20, family="Times New Roman"), legend.position = "none") + coord_cartesian(ylim= c(0.4,1)) + scale_y_continuous(breaks=c(0.5, 0.6, 0.7, 0.8, 0.9, 1))  + scale_color_manual(values=c("black","blue1")) + scale_x_discrete(labels=c("AvgCorrect_Sm_NumeralQuantity" = "Small", "AvgCorrect_Med_NumeralQuantity" = "Medium", "AvgCorrect_Lrg_NumeralQuantity" = "Large"))
QN

#6. NUMERAL TO QUANTITY SCATTER PLOT#
which(colnames(Map_HBE)=="SumTotal_QuantityNumeral")
long_setsizes_NQ  <- Map_HBE[,-(77)] #getting rid of sum columns to only have avg ones
long_setsizes_NQ2  <- pivot_longer(data = long_setsizes_NQ, cols=c(ends_with("QuantityNumeral")), names_to = c("SetSize"), values_to = "Performance") 
View(long_setsizes_NQ2)
long_setsizes_NQ2$AgeGrp <- ifelse(long_setsizes_NQ2$Age_Rounded < 7, "5", "7") #adding age grp column to only have the numbers
View(long_setsizes_NQ2) 
AgeGrps <- long_setsizes_NQ2$AgeGrp #creating short variable
long_setsizes_NQ2$SetSize <- factor(long_setsizes_NQ2$SetSize, levels=c("AvgCorrect_Sm_QuantityNumeral", "AvgCorrect_Med_QuantityNumeral", "AvgCorrect_Lrg_QuantityNumeral")) #SETTING IN ORDER, from small to large
jitter <- position_jitter(width=0.4, height=0.02)
NQ <- ggplot(long_setsizes_NQ2, aes(x=long_setsizes_NQ2$SetSize, y=long_setsizes_NQ2$Performance)) + geom_point(aes(shape=AgeGrps, color=AgeGrps), show.legend = FALSE, position=jitter, size=2)+ stat_smooth(aes(group = AgeGrps, color=AgeGrps), method = "loess", se=FALSE) + labs(x="Set Sizes", y="Numeral-Quantity") + theme(text = element_text(size=20, family="Times New Roman"), legend.position = "none") + coord_cartesian(ylim= c(0.4,1)) + scale_y_continuous(breaks=c(0.5, 0.6, 0.7, 0.8, 0.9, 1))  + scale_color_manual(values=c("black","blue1")) + scale_x_discrete(labels=c("AvgCorrect_Sm_QuantityNumeral" = "Small", "AvgCorrect_Med_QuantityNumeral" = "Medium", "AvgCorrect_Lrg_QuantityNumeral" = "Large"))
NQ

grid.arrange(NQ,WQ,WN,QN,QW,NW, ncol = 3)

#CEILING PERFORMANCE PREVALENCE?#
NW <- Map_HBE$Sum_Numeral.Word_Word.Numeral
C_NW <- 17
Var_NW_2 <- length(which(NW>= C_NW)) #number of observations that are equal to 17 (ceiling)
N <- nrow(Map_HBE)
(Var_NW_2/N)*100 #61.9% AT CEILING
#SCATTERPLOT FOR NUMERAL AND WORD PERFORMANCE#
NW <- ggplot(Map_HBE, aes(x=Map_HBE$Age_Rounded, y=Map_HBE$Sum_Numeral.Word_Word.Numeral)) + geom_point() + geom_smooth(method="loess", se = FALSE) + labs(x="Age (Years)", y="Numeral and Word") + theme(text = element_text(size=11)) + coord_cartesian(xlim = c(5, 10), ylim= c(10,17)) + scale_y_continuous(breaks=c(10, 11, 12, 13, 14, 15,16,17)) + scale_x_continuous(breaks=c(5, 6, 7, 8, 9))
NW
