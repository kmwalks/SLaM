#1. Install and Load Libraries 

install.packages("tidyverse") # includes ggplot2
install.packages("ggplot2") # for general plots
install.packages("beeswarm") # for beeswarm plots
install.packages("colorspace") # for fixing colors in beeswarm plots
install.packages("stargazer") # for pretty regression output tables
install.packages("MASS") # for polr package
install.packages("generalhoslem") # for testing model fit (lipsitz test and two others)
install.packages("qwraps2") # for summary_table use
install.packages("quantreg") # testing quantile plots (geom_quantile) and quantile regressions
install.packages ("olsrr") #for testing normality

library(tidyverse) 
library(ggplot2) 
library(beeswarm)
library(colorspace) 
library(stargazer) 
library(MASS) 
library(generalhoslem) 
library(qwraps2) 
library(quantreg) 
library(olsrr)


#2. Check and Set Working Directory
      #LAB
      setwd("/Users/labuser/Documents/R")
      getwd() #to see where is set to
      #LAPTOP
      setwd("~/Desktop")
      getwd()
      
      
#3. Import Data [[make sure is most recent version and saved as csv]]
      Map <- read.csv("Mapping_Coding_KW_190709.csv", na.strings = "N/A")
      View(Map)
      # <- saves MC as an object, read.csv() imports it 
      
#4. Subset overall data with particular parameters (i.e. including P, coded, test using, age range)
      Map_EE <- subset(Map, Map$Coded. == "Yes"  & Map$Group_4cat == "English Early" & Map$Age_Rounded<10 & Map$Including.in.Study == "Yes")
      View(Map_EE)

#Other
      #Analyze Participant Pool
      sum(Map_EE$Group_4cat == 'English Early', na.rm=TRUE)
      
#Plots
      #Violin/Box Plot SES
      map.n <- function(x){return(c(y = median(x)*1.05, label = length(x))) }
      mean.n <- function(x){return(c(y= median(x)*0.97, label = round(mean(x), 2)))}
      ggplot(Map_EE, aes(x = Map_EE$Group_4cat, y = Map_EE$SES_range_8_to_66, fill = Map_EE$Group_4cat)) + geom_violin() + geom_boxplot(width = 0.2) + labs (x= "Language Group", y = "SES") + stat_summary(fun.data = map.n, geom = "text", fun.y = median) + stat_summary(fun.data = mean.n, geom= "text", fun.y=mean, color= "gainsboro") + theme(legend.position="none") 

      #Violin Age
      ggplot(Map_EE, aes(x=Map_EE$Group_4cat, y=Map_EE$Age_Rounded, fill=Map_EE$Group_4cat)) + geom_violin() + labs(x="Timing of Language Exposure", y= "Age (years)") + theme(legend.position="none") 
      
